#!/bin/bash

# jj - jjot Quick Note CLI Tool
# Appends notes to a single file with minimal timestamp metadata

set -e

# Configuration
JJ_FILE="${JJ_FILE:-$HOME/Documents/secondbrain/Quick Notes.md}"

# Prompt for note
printf "Note: "
read -r note

# Check for empty input
if [[ -z "$note" ]]; then
    echo "Empty note, nothing added."
    exit 1
fi

# Check if target directory exists
target_dir="$(dirname "$JJ_FILE")"
if [[ ! -d "$target_dir" ]]; then
    echo "Error: Directory does not exist: $target_dir"
    exit 1
fi

# Format timestamp: Fri Dec 27 · 2:32 PM EST
timestamp="$(date '+%a %b %-d · %-I:%M %p %Z')"

# Append note to file
{
    echo ""
    echo "---"
    echo ""
    echo "**$timestamp**"
    echo ""
    echo "$note"
} >> "$JJ_FILE"

echo "Note added."
